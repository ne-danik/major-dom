const headerNav=document.querySelector(".header__nav"),sticky=headerNav.offsetTop,burgerBtn=document.querySelector('[data-btn="burger-menu"]'),burgerMenu=document.querySelector(".burger-menu");let rooms=[];const roomsRequest=new XMLHttpRequest;if(roomsRequest.open("GET","js/rooms.json",!1),roomsRequest.onload=function(e){4==roomsRequest.readyState&&200==roomsRequest.status&&(rooms=JSON.parse(roomsRequest.responseText))},roomsRequest.send(null),document.addEventListener("scroll",(function(){window.pageYOffset>=sticky?headerNav.classList.add("header__nav--fixed"):headerNav.classList.remove("header__nav--fixed"),0==window.pageYOffset&&1==burgerMenu.classList.contains("open-menu")&&(burgerMenu.classList.toggle("open-menu"),1==burgerBtn.classList.contains("open-menu")&&burgerBtn.classList.toggle("open-menu"))})),window.innerWidth<=640){const e=document.querySelectorAll(".burger-menu__link");for(let t=0;t<e.length;t++)e[t].addEventListener("click",e=>{1==burgerBtn.classList.contains("open-menu")&&burgerBtn.classList.toggle("open-menu"),burgerMenu.classList.toggle("open-menu"),e.target.closest(".burger-menu").blur(),"hidden"==document.querySelector("body").style.overflowY?document.querySelector("body").style.overflowY="":document.querySelector("body").style.overflowY="hidden"})}burgerBtn.addEventListener("click",e=>{e.target.classList.toggle("open-menu"),burgerMenu.classList.toggle("open-menu"),window.innerWidth<=640&&("hidden"==document.querySelector("body").style.overflowY?document.querySelector("body").style.overflowY="":document.querySelector("body").style.overflowY="hidden")});class RoomsSlide{constructor(e,t,s,n){this._title=e,this._price=t,this._tags=s,this._thumb=n}render(){const e=document.querySelector('[data-slider="rooms"]'),t=document.createElement("div");t.classList.add("splide__slide"),t.setAttribute("data-slide","room"),t.innerHTML=`\n      <div class="room__image">\n        <img src='${this._thumb}' alt='${this._title}'>\n      </div>\n      <div class="room__content">\n        <h5 class="room__content-title">${this._title}</h5>\n        <p class="room__content-features">${this._tags.join(" • ")}</p>\n        <div class="room__footer">\n          <a class="link-btn room-btn" href="#" data-modal="room">Подробнее</a>\n          <p class="room__price">от <span>${this._price} ₽</span><br/>сутки/чел.</p>\n        </div>\n      </div>\n    `,e.append(t)}}const roomsSliderPromise=new Promise((function(e){for(let e=0;e<rooms.length;e++)new RoomsSlide(rooms[e].title,rooms[e].price,rooms[e].tags,rooms[e].thumb[0]).render();e()})).then(()=>{new Splide(".splide",{type:"slide",perPage:2,perMove:2,rewind:!1,pagination:!1,fixedWidth:"445px",width:"1110px",gap:60,speed:500,keyboard:!0,breakpoints:{1366:{fixedWidth:"340px",gap:60,width:"968px"},1024:{fixedWidth:"320px",width:"768px",gap:45},960:{focus:"center",perPage:1,perMove:1,fixedWidth:"340px",width:"600px",gap:60},640:{perPage:1,fixedWidth:"280px",width:"290px",gap:30}}}).mount()}),headerSlider=new Splide(".header__slider",{type:"fade",rewind:!0,arrows:!1,pagination:!0,width:"100%",autoplay:!0,interval:1e4,speed:2e3,pauseOnHover:!1,pauseOnFocus:!1}).mount();class Modal{constructor(e){this._hidePrevModals(),this._title=e.title,this._subtitle=e.subtitle,this._content=e.content,this._width=e.width||600,this._create(),this._el.addEventListener("click",e=>{"close"!==e.target.dataset.modalBtn&&e.target!==this._el||this._hide()})}_hidePrevModals(){document.querySelectorAll(".modal").forEach(e=>{e.remove()})}_hide(){this._el.remove(),document.body.style.overflow="";const e=new CustomEvent("hide.modal",{detail:{target:this._el}});document.dispatchEvent(e)}_create(){const e=document.createElement("div"),t=!1!==this._title?`<h3 class="modal__title">${this._title}</h3>`:"",s=!1!==this._subtitle?`<p class="modal__subtitle">${this._subtitle}</p>`:"",n=!1!==this._content?`<div class="modal__content">${this._content}</div>`:"";e.classList.add("modal");const o="string"!=typeof this._width?this._width+"px":this._width;e.innerHTML=`\n      <div class="modal__dialog" style="max-width:${o};">\n        <button class="modal__btn-close" data-modal-btn="close"></button>\n        <div class="modal__header">\n          ${t}\n          ${s}\n        </div>\n        ${n}\n      </div>\n    `,this._el=e,document.body.style.overflow="hidden",document.body.append(e)}}document.addEventListener("click",e=>{e.target.dataset.modal&&e.preventDefault(),"feedback"===e.target.dataset.modal&&new Modal({title:"Оставьте заявку",subtitle:!1,content:'\n        <form class="feedback__modal-form" method="post" action="#">\n          <input type="text" name="fristname" id="fristname" placeholder="Имя" required>\n          <input type="tel" name="phone" id="phone" placeholder="+7 (123) 456-78-90" required>\n          <div class="feedback__modal-privacy">\n          <input type="checkbox" name="privacy" id="modal-privacy" required>\n          <label for="modal-privacy">\n              Отправляя нам свои данные, Вы соглашаетесь с \n              <a href="#" class="feedback__modal-privacy-text">\n                политикой конфиденциальности\n              </a>\n              </label>\n            </div>\n            <button class="link-btn" type="submit">Отправить</button>\n        </form>'})});const message={loading:'<p class="send send--wait">Отправляется...</p>',success:'<p class="send send--success">Успешно отправлено!</p>',failure:'<p class="send send--error">Ошибка!</p>'};document.addEventListener("submit",e=>{document.querySelectorAll("form").forEach(t=>{e.preventDefault(),new Modal({title:!1,subtitle:!1,content:message.loading});const s=new XMLHttpRequest;s.open("POST","server.php"),s.setRequestHeader("Content-type","application/json");const n=new FormData(t),o={};n.forEach((function(e,t){o[t]=e}));const i=JSON.stringify(o);s.send(i),s.addEventListener("load",()=>{200===s.status?(t.reset(),new Modal({title:"Успех",subtitle:!1,content:message.success})):new Modal({title:"Не отправлено",subtitle:!1,content:message.failure})})})});const roomSlides=document.querySelectorAll('[data-slide="room"]');for(let e=0;e<roomSlides.length;e++)roomSlides[e].addEventListener("click",t=>{if("room"===t.target.dataset.modal){let t="";rooms[e].services.forEach(e=>{t+=`<li class="service__item">${e}</li>`});let s="";rooms[e].thumb.forEach(e=>{s+=`\n            <li class="splide__slide">\n              <img src="${e}" alt="${e}" />\n            </li>\n        `});let n="";rooms[e].thumb.forEach(e=>{n+=`\n            <li class="thumbnail">\n              <img src="${e}" alt="${e}" />\n            </li>\n        `}),new Modal({title:rooms[e].title,subtitle:!1,content:`\n          <div id="main-slider" class="splide">\n            <div class="splide__arrows rooms__slider-arrows">\n              <button class="splide__arrow splide__arrow--prev"></button>\n              <button class="splide__arrow splide__arrow--next"></button>\n            </div>\n            <div class="splide__track">\n              <ul class="splide__list">\n                ${s}\n              </ul>\n            </div>\n          </div>\n          <ul id="thumbnails" class="thumbnails">\n            ${n}\n          </ul>\n          <div class="room-modal__content-btn">\n            <div class="room-modal__content-price">\n              <p>от <span>${rooms[e].price} ₽</span></p>\n              <p>сутки/чел.</p>\n            </div>\n            <button class="link-btn" type="submit" data-modal="feedback">Забронировать</button>\n          </div>\n\n          <div class="room-modal__content">\n            <div>\n              <ul class="room-modal__benefits">\n                <li class="room-modal__benefits-item">\n                  <img src='images/icons/wifi.svg' alt='Бесплатный Wi-Fi'> Бесплатный Wi-Fi\n                </li>\n                <li class="room-modal__benefits-item">\n                  <img src='images/icons/parking.svg' alt='Бесплатная парковка'> Бесплатная парковка\n                </li>\n              </ul>\n            </div>\n            <div><strong>Площадь номера</strong> ${rooms[e].area} м²</div>\n            <div><strong>Курение:</strong> ${rooms[e].smoking}</div>\n            <div>\n              <p><strong>Услуги и удобства:</strong></p>\n              <ul class="room-modal__services-list">${t}</ul>\n            </div>\n          </div>\n          `,width:968}),createThumbSlider()}});function createThumbSlider(){const e=new Splide("#main-slider",{width:600,height:400,pagination:!1,cover:!0,breakpoints:{960:{height:320},640:{height:240}}});let t,s=document.querySelectorAll(".thumbnail");for(var n=0;n<s.length;n++)o(s[n],n);function o(t,s){t.addEventListener("click",(function(){e.go(s)}))}e.on("mounted moved",(function(){var n=s[e.index];n&&(t&&t.classList.remove("is-active"),n.classList.add("is-active"),t=n)})),e.mount()}